import { Component, Input, OnInit } from '@angular/core';
import { Router } from '@angular/router';
import { Statue } from 'src/db';

@Component({
  selector: 'app-map',
  templateUrl: './map.component.html',
  styleUrls: ['./map.component.scss'],
})
export class MapComponent implements OnInit {
  @Input() statues: Statue[];
  @Input() visitedStatues: Statue[];

  display: any;
  center: google.maps.LatLngLiteral = {
    lat: -8.0539813,
    lng: -34.8773289,
  };
  zoom = 13.8;
  markers = [];

  constructor(private router: Router) {}

  ngOnInit(): void {
    this.markers = this.statues.map((statue) => ({
      position: {
        lat: Number(statue.coordinates[0]),
        lng: Number(statue.coordinates[1]),
      },
      title: statue.id.toString(),
      options: {
        icon: {
          url: this.visitedStatues.find(
            (visitedStatue) => statue.name === visitedStatue.name
          )
            ? 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTEiIGhlaWdodD0iMTMiIHZpZXdCb3g9IjAgMCAxMSAxMyIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTUuNSA0LjE1MTM3QzUuMTIwNDEgNC4xNTEzNyA0Ljc2MzY3IDQuMjk4NjMgNC40OTQ1MyA0LjU2Nzc3QzQuMzYyMjggNC42OTk2NSA0LjI1NzQgNC44NTYzNyA0LjE4NTk0IDUuMDI4OTNDNC4xMTQ0NyA1LjIwMTQ5IDQuMDc3ODMgNS4zODY0NyA0LjA3ODEyIDUuNTczMjRDNC4wNzgxMiA1Ljk1MjgzIDQuMjI2NjYgNi4zMDk1NyA0LjQ5NDUzIDYuNTc4NzFDNC42MjY0MSA2LjcxMDk3IDQuNzgzMTMgNi44MTU4NCA0Ljk1NTY5IDYuODg3MzFDNS4xMjgyNSA2Ljk1ODc3IDUuMzEzMjMgNi45OTU0MSA1LjUgNi45OTUxMkM1Ljg3OTU5IDYuOTk1MTIgNi4yMzYzMyA2Ljg0NjU4IDYuNTA1NDcgNi41Nzg3MUM2Ljc3NDYxIDYuMzA5NTcgNi45MjE4OCA1Ljk1MjgzIDYuOTIxODggNS41NzMyNEM2LjkyMTg4IDUuMTkzNjUgNi43NzQ2MSA0LjgzNjkxIDYuNTA1NDcgNC41Njc3N0M2LjIzNjMzIDQuMjk4NjMgNS44Nzk1OSA0LjE1MTM3IDUuNSA0LjE1MTM3Wk05Ljg0OTQxIDMuNjcwMjFDOS42MTA0MSAzLjExOTA5IDkuMjY1ODEgMi42MjAwOCA4LjgzNTA2IDIuMjAxMzdDOC40MDI5IDEuNzc4ODcgNy44OTM0MyAxLjQ0MzUzIDcuMzM0NDcgMS4yMTM2N0M2Ljc1MzAzIDAuOTcyNDYxIDYuMTM2MDMgMC44NTA1ODYgNS41IDAuODUwNTg2QzQuODYzOTcgMC44NTA1ODYgNC4yNDY5NyAwLjk3MjQ2MSAzLjY2NTUzIDEuMjEyNEMzLjEwMzEzIDEuNDQ0NzMgMi41OTkxMiAxLjc3NzM0IDIuMTY0OTQgMi4yMDAxQzEuNzM0NDcgMi42MTkwNSAxLjM4OTkxIDMuMTE3OTkgMS4xNTA1OSAzLjY2ODk1QzAuOTAzMDI3IDQuMjQwMjMgMC43NzczNDQgNC44NDcwNyAwLjc3NzM0NCA1LjQ3MTY4QzAuNzc3MzQ0IDYuMzY3OTcgMC45OTE4OTUgNy4yNjA0NSAxLjQxMzM4IDguMTIxMTlDMS43NTIzNCA4LjgxMzA5IDIuMjI1ODggOS40ODcyMSAyLjgyMjU2IDEwLjEyODNDMy44NDE5OSAxMS4yMjI3IDQuOTEwOTQgMTEuODkxNyA1LjIxNDM2IDEyLjA3MDdDNS4zMDA0OCAxMi4xMjE2IDUuMzk4NzEgMTIuMTQ4MyA1LjQ5ODczIDEyLjE0ODFDNS41OTc3NSAxMi4xNDgxIDUuNjk1NTEgMTIuMTIyOCA1Ljc4MzExIDEyLjA3MDdDNi4wODY1MiAxMS44OTE3IDcuMTU1NDcgMTEuMjIyNyA4LjE3NDkgMTAuMTI4M0M4Ljc3MTU4IDkuNDg4NDggOS4yNDUxMiA4LjgxMzA5IDkuNTg0MDggOC4xMjExOUMxMC4wMDgxIDcuMjYxNzIgMTAuMjIyNyA2LjM3MDUxIDEwLjIyMjcgNS40NzI5NUMxMC4yMjI3IDQuODQ4MzQgMTAuMDk3IDQuMjQxNSA5Ljg0OTQxIDMuNjcwMjFaTTUuNSA3LjgwNzYyQzQuMjY2MDIgNy44MDc2MiAzLjI2NTYyIDYuODA3MjMgMy4yNjU2MiA1LjU3MzI0QzMuMjY1NjIgNC4zMzkyNiA0LjI2NjAyIDMuMzM4ODcgNS41IDMuMzM4ODdDNi43MzM5OCAzLjMzODg3IDcuNzM0MzggNC4zMzkyNiA3LjczNDM4IDUuNTczMjRDNy43MzQzOCA2LjgwNzIzIDYuNzMzOTggNy44MDc2MiA1LjUgNy44MDc2MloiIGZpbGw9IiM4QzYzMTgiLz4KPC9zdmc+Cg=='
            : 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTEiIGhlaWdodD0iMTMiIHZpZXdCb3g9IjAgMCAxMSAxMyIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTUuNSA0LjE1MTM3QzUuMTIwNDEgNC4xNTEzNyA0Ljc2MzY3IDQuMjk4NjMgNC40OTQ1MyA0LjU2Nzc3QzQuMzYyMjggNC42OTk2NSA0LjI1NzQgNC44NTYzNyA0LjE4NTk0IDUuMDI4OTNDNC4xMTQ0NyA1LjIwMTQ5IDQuMDc3ODMgNS4zODY0NyA0LjA3ODEyIDUuNTczMjRDNC4wNzgxMiA1Ljk1MjgzIDQuMjI2NjYgNi4zMDk1NyA0LjQ5NDUzIDYuNTc4NzFDNC42MjY0MSA2LjcxMDk3IDQuNzgzMTMgNi44MTU4NCA0Ljk1NTY5IDYuODg3MzFDNS4xMjgyNSA2Ljk1ODc3IDUuMzEzMjMgNi45OTU0MSA1LjUgNi45OTUxMkM1Ljg3OTU5IDYuOTk1MTIgNi4yMzYzMyA2Ljg0NjU4IDYuNTA1NDcgNi41Nzg3MUM2Ljc3NDYxIDYuMzA5NTcgNi45MjE4OCA1Ljk1MjgzIDYuOTIxODggNS41NzMyNEM2LjkyMTg4IDUuMTkzNjUgNi43NzQ2MSA0LjgzNjkxIDYuNTA1NDcgNC41Njc3N0M2LjIzNjMzIDQuMjk4NjMgNS44Nzk1OSA0LjE1MTM3IDUuNSA0LjE1MTM3Wk05Ljg0OTQxIDMuNjcwMjFDOS42MTA0MSAzLjExOTA5IDkuMjY1ODEgMi42MjAwOCA4LjgzNTA2IDIuMjAxMzdDOC40MDI5IDEuNzc4ODcgNy44OTM0MyAxLjQ0MzUzIDcuMzM0NDcgMS4yMTM2N0M2Ljc1MzAzIDAuOTcyNDYxIDYuMTM2MDMgMC44NTA1ODYgNS41IDAuODUwNTg2QzQuODYzOTcgMC44NTA1ODYgNC4yNDY5NyAwLjk3MjQ2MSAzLjY2NTUzIDEuMjEyNEMzLjEwMzEzIDEuNDQ0NzMgMi41OTkxMiAxLjc3NzM0IDIuMTY0OTQgMi4yMDAxQzEuNzM0NDcgMi42MTkwNSAxLjM4OTkxIDMuMTE3OTkgMS4xNTA1OSAzLjY2ODk1QzAuOTAzMDI3IDQuMjQwMjMgMC43NzczNDQgNC44NDcwNyAwLjc3NzM0NCA1LjQ3MTY4QzAuNzc3MzQ0IDYuMzY3OTcgMC45OTE4OTUgNy4yNjA0NSAxLjQxMzM4IDguMTIxMTlDMS43NTIzNCA4LjgxMzA5IDIuMjI1ODggOS40ODcyMSAyLjgyMjU2IDEwLjEyODNDMy44NDE5OSAxMS4yMjI3IDQuOTEwOTQgMTEuODkxNyA1LjIxNDM2IDEyLjA3MDdDNS4zMDA0OCAxMi4xMjE2IDUuMzk4NzEgMTIuMTQ4MyA1LjQ5ODczIDEyLjE0ODFDNS41OTc3NSAxMi4xNDgxIDUuNjk1NTEgMTIuMTIyOCA1Ljc4MzExIDEyLjA3MDdDNi4wODY1MiAxMS44OTE3IDcuMTU1NDcgMTEuMjIyNyA4LjE3NDkgMTAuMTI4M0M4Ljc3MTU4IDkuNDg4NDggOS4yNDUxMiA4LjgxMzA5IDkuNTg0MDggOC4xMjExOUMxMC4wMDgxIDcuMjYxNzIgMTAuMjIyNyA2LjM3MDUxIDEwLjIyMjcgNS40NzI5NUMxMC4yMjI3IDQuODQ4MzQgMTAuMDk3IDQuMjQxNSA5Ljg0OTQxIDMuNjcwMjFaTTUuNSA3LjgwNzYyQzQuMjY2MDIgNy44MDc2MiAzLjI2NTYyIDYuODA3MjMgMy4yNjU2MiA1LjU3MzI0QzMuMjY1NjIgNC4zMzkyNiA0LjI2NjAyIDMuMzM4ODcgNS41IDMuMzM4ODdDNi43MzM5OCAzLjMzODg3IDcuNzM0MzggNC4zMzkyNiA3LjczNDM4IDUuNTczMjRDNy43MzQzOCA2LjgwNzIzIDYuNzMzOTggNy44MDc2MiA1LjUgNy44MDc2MloiIGZpbGw9IiNGRkZFQUUiIHN0cm9rZT0iI0JEOTcxNyIgc3Ryb2tlLXdpZHRoPSIwLjUiLz4KPC9zdmc+Cg==',
          scaledSize: new google.maps.Size(40, 40),
        },
      },
    }));
  }

  onMarkerClick(marker: any): void {
    this.router.navigate([`/writer/${marker.title}`]);
  }

  moveMap(event: google.maps.MapMouseEvent): void {
    if (event.latLng != null) this.center = event.latLng.toJSON();
  }

  move(event: google.maps.MapMouseEvent): void {
    if (event.latLng != null) this.display = event.latLng.toJSON();
  }
}
